{% extends 'layout.html.twig' %}

{% block title %}Liste des sorties{% endblock %}

{% block body %}

   {% if is_granted('IS_AUTHENTICATED_FULLY') %}
      <p style="text-align: right">Date du jour : <strong>{{ dateDuJour }}</strong></p>
      <P style="text-align: right">Participant : <strong>{{ participant }}</strong></P>

      {{ form_start(formFiltre) }}

      <div class="row">
         <div class="form-group col-3">
            <label>Site :</label>
            {{ form_widget(formFiltre.site) }}
         </div>

         <div class="form-group col-3">
            <label>Le nom de la sortie contient :</label>
            {{ form_widget(formFiltre.nom) }}
         </div>

         <div class="form-group col-3">
            <label>À partir de :</label>
            {{ form_widget(formFiltre.dateDebut) }}
         </div>

         <div class="form-group col-3">
            <label>Jusqu'au :</label>
            {{ form_widget(formFiltre.dateCloture) }}
         </div>
      </div>

      <input class="btn btn-primary btn-block" type="submit" value="Rechercher">

      {{ form_end(formFiltre) }}

      <br>

      <table class="table table-striped">
         <thead>
         <tr>
            <th scope="col">Nom de la sortie</th>
            <th scope="col">Date</th>
            <th scope="col">Clôture</th>
            <th scope="col">Nombre d'inscrits</th>
            <th scope="col">État</th>
            <th scope="col">Inscrit</th>
            <th scope="col">Organisateur</th>
            <th scope="col">Actions</th>
         </tr>
         </thead>
         <tbody>

         {% for sortie in sorties %}
            <tr>
               <td>{{ sortie.nom }}</td>
               <td>{{ sortie.dateDebut|date("d/m/Y H:i") }}</td>
               <td>{{ sortie.dateCloture|date("d/m/Y") }}</td>
               <td align="center">{{ sortie.nbInscriptions }}/{{ sortie.nbInscriptionsMax }}</td>
               <td>{{ sortie.etat.libelle }}</td>
               {% if sortie.inscrit %}
                  <td align="center"><img src="{{ asset("img/checked.png") }}" width="24px"></td>
               {% else %}
                  <td align="center"><img src="{{ asset("img/unchecked.png") }}" width="24px"></td>
               {% endif %}
               <td>{{ sortie.organisateur.username }}</td>
               <td>
                  {% for action in sortie.actions %}
                     {% if action == "modifier" %}
                        <a class="btn btn-outline-info" href="#">Modifier</a>
                     {% endif %}
                     {% if action == "publier" %}
                        <a class="btn btn-outline-success" href="#">Publier</a>
                     {% endif %}
                     {% if action == "afficher" %}
                        <a class="btn btn-outline-primary" href="#">Afficher</a>
                     {% endif %}
                     {% if action == "annuler" %}
                        <a class="btn btn-outline-danger" href="#">Annuler</a>
                     {% endif %}
                     {% if action == "desister" %}
                        <a class="btn btn-outline-warning" href="#">Se désister</a>
                     {% endif %}
                     {% if action == "inscrire" %}
                        <a class="btn btn-outline-success" href="#">S'inscrire</a>
                     {% endif %}
                  {% endfor %}
               </td>
            </tr>
         {% endfor %}
         </tbody>
      </table>

      <a class="btn btn-success" href="{{ path('sortie_creer') }}">Créer une sortie</a>
   {% else %}
      <h1>VOUS N'ÊTES PAS CONNECTÉ</h1>
   {% endif %}
{% endblock %}